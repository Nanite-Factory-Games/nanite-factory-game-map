<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Hello wasm-pack!</title>
    <script type="module">
        import init, { start, submit_timeline_frame } from "./out/nanite_factory_game_map.js";
        
        window.onload = () => {
        (async () => {
            let res = await fetch('./out/assets.json');
            let assets = (await res.json());
            let timeline = await (await fetch('./generate_frames/frames.json')).json();
            console.log(timeline);

            init().then(()=>{
                new Promise(() => {
                  start({
                    tickrate: 4,
                    controls_enabled: true,
                    loop_timeline: true,
                    assets,
                    camera_position: [0, 0],
                    follow_id: null,
                    canvas_id: "#canvas",
                  });
                });
                setTimeout(() => {
                  console.log("started frames type is " + typeof timeline);
                  for (let frame of timeline) {
                      console.log(frame);
                      submit_timeline_frame(frame);
                  }
                }, 10000);
                
            });
        })();
    }
        
        

    </script>
  </head>
  <body>
    <canvas id="canvas" width="800" height="600" style="border: 1px solid black"></canvas>
  </body>